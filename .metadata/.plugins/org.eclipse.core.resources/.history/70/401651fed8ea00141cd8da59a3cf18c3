package sentiment;

import java.io.*;
import weka.core.*;

public class TextDirectoryToArff {
    public static Instances createDataset(String directoryPath) throws IOException {
        FastVector atts = new FastVector(2);
        atts.addElement(new Attribute("label", (FastVector) null));
        atts.addElement(new Attribute("content", (FastVector) null));
        Instances data = new Instances("train", atts, 0);

        File dir = new File(directoryPath);
        String[] files = dir.list();
        for (int i = 0; i < files.length; i++) {
            if (files[i].endsWith(".txt")) {
                double[] newInst = new double[2];
                newInst[0] = (double) data.attribute(0).addStringValue(files[i]);
                File txt = new File(directoryPath + File.separator + files[i]);
                InputStreamReader reader = new InputStreamReader(new FileInputStream(txt));
                StringBuffer txtStr = new StringBuffer();
                int c;
                while ((c = reader.read()) != -1) {
                    txtStr.append((char) c);
                }
                newInst[1] = (double) data.attribute(1).addStringValue(txtStr.toString());
                data.add(new Instance(1.0, newInst));
                reader.close();
            }
        }
        return data;
    }

    public static void main(String[] args) {
        String dir = "../data/sentiment/txt_sentoken/";
        try {
            Instances dataset = TextDirectoryToArff.createDataset(dir);
            //System.out.println(dataset.instance(0));
            System.out.println(dataset);
        } catch (Exception e) {
            System.err.println(e.getMessage());
            e.printStackTrace();
        }
    }
}