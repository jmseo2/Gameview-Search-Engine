package dataindex;

import java.io.File;
import java.io.IOException;
import java.nio.file.Path;
import java.util.*;

import org.apache.lucene.store.*;

/*
 * Core class that indexes text files located at directory directory
 */

public class DataIndexer {
	private String dataDirectory;
	private List<String> fieldTypes;
	private List<String> fieldNames;
	private Directory index;
	public DataIndexer() {
		fieldTypes = new ArrayList<String>();
		fieldNames = new ArrayList<String>();
	}
	
	public DataIndexer createIndex(String directory) {
		try {
			File file = new File(directory);
			index = new SimpleFSDirectory(file.toPath());
		} catch (IOException e) {
			e.printStackTrace();
		}
		return this;
	}
	
	public DataIndexer setDataDirectory(String directory) {
		dataDirectory = directory;
		return this;
	}
	
	public DataIndexer addField(String fieldType, String name) {
		fieldTypes.add(fieldType);
		fieldNames.add(name);
		return this;
	}
	
	public void indexData() {
		try {
			File folder = new File(dataDirectory);
			for (File fileEntry : folder.listFiles()) {
				if (!fileEntry.isDirectory()) {
					indexFile(fileEntry);
				}
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	
	public void indexFile(File file) throws IOException {
		String [] data = Utility.readWebpageTextData(file.getAbsolutePath());
		if (data.length == fieldTypes.size()) {
			for (int i = 0; i < fieldTypes.size(); i++) {
				String fieldType = fieldTypes.get(i);
				String fieldName = fieldNames.get(i);
				
				if (fieldType.equals("STRING_FIELD")) {
					
				}
			}
		} else {
			System.out.println("Data in wrong format... ignoring");
		}
	}
}
