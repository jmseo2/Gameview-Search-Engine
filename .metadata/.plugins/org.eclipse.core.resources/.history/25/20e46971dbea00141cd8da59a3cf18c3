package sentiment;

import java.io.*;
import weka.core.*;

public class TextDirectoryToArff {
    public static Instances createDataset(String directoryPath) throws IOException {
        Attribute contentAtt = new Attribute("content", (FastVector) null);
        FastVector classVal = new FastVector(2);
        classVal.addElement("neg");
        classVal.addElement("pos");
        Attribute classAtt = new Attribute("class", classVal);
        
        FastVector atts = new FastVector(2);
        atts.addElement(contentAtt);
        atts.addElement(classAtt);
        Instances data = new Instances("train", atts, 0);
        data.setClassIndex(1);

        File dir = new File(directoryPath);
        File[] folders = dir.listFiles();
        for (File folder : folders) {
            File [] files = folder.listFiles();
            for (File file : files) {
                if (file.getName().endsWith(".txt")) {
                    InputStreamReader reader = new InputStreamReader(new FileInputStream(file));
                    StringBuffer txtStr = new StringBuffer();
                    int c;
                    while ((c = reader.read()) != -1) {
                        txtStr.append((char) c);
                    }
                    Instance inst = new Instance(2);
                    inst.setValue(data.attribute(0), txtStr.toString());
                    //inst.setValue(data.attribute(1), folder.getName());
                    inst.setMissing(data.attribute(1));
                    data.add(inst);
                    reader.close();
                }
            }
        }
        return data;
    }

    public static void main(String[] args) {
        String dir = "../data/sentiment/txt_sentoken/";
        try {
            Instances dataset = TextDirectoryToArff.createDataset(dir);
            //System.out.println(dataset.instance(0));
            Instance inst = dataset.instance(0);
            System.out.println(inst);
        } catch (Exception e) {
            System.err.println(e.getMessage());
            e.printStackTrace();
        }
    }
}