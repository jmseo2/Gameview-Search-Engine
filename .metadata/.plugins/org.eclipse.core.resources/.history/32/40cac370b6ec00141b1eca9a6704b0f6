package dataquery;

import java.io.IOException;

import org.apache.lucene.document.Document;
import util.Utility;

public class QueryData {
    public static void main(String[] args) {
        if (args.length != 2) {
            System.out.println("Usage: java [query] [numdocs]");
            return;
        }
        String query = args[0];
        int numDocs = Integer.parseInt(args[1]);
        try {
            DataQuerier querier 
                = new DataQuerier()
                    .setIndexDirectory("../data/indexboosted/")
                    .setFieldType("title")
                    .setQuery(query)
                    .setup();
            Document[] docs = querier.getRetrievedDocs(20);
            for (Document doc : docs) {
                System.out.println(doc.get("docid"));
                System.out.println(doc.get("title"));
                System.out.println(doc.get("url"));
                System.out.println();
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
